haskellを使った馴れ初めと今の使い方
===================================

もともとはVerilogを書く仕事でした。

~~~~
FPGAボード → 光源ドライバ → 光源
~~~~


光源駆動の開発をPWMを色々変化させながら試したいという人がいたので
上の構成でVerilogを書く仕事をやりました。
まあ仕事といっても「お手伝い」という程度でした。

要望をくれた方(利用者)は普段、一緒に仕事をしている間柄ではなく
密にコミュニケーションを取れないので、

* メンテナンスに時間をかけない (他に本来やらなきゃいけない業務があるので)
* 開発に時間をかけない (あくまでも試しにやってみるという程度なので)
* 他環境での動作確認に時間をかけない (こんな所で躓きたくないから)
* 知識がなくても手軽に使えるものにしたい (サポートに時間を掛けたくないから)

という「一発売り切りでサポートしない(する必要がないレベルにする)」方針でいく事にしました。

FPGAに様々なPWMデータをセットするため、
PWMデータをFPGAに送り込むPC側のアプリケーションもちょっと作る必要がありました。

FPGAにセットされているデータは
単なる「アドレス-レジスタ値」のバイナリデータで、Human Readableでない状態です。
自分で使うなら自分でデータを打ちこめばいいのですが、
他の方が使うという事でHuman ReadableなPWM記述データを用意しました。


という事で

* PWMの記述データのパーサ
* FPGAへのデータ送受信用クライアント

以上のプログラムを何で書くか迷いました。

Visual Basic?
-------------
  一回GUIで簡単なクライアントソフトを作った事があった。
  通信クライアントを作った時の反省
  COMポート関連のdll不足、.NET Flameworkのバージョン等、
  互換性の問題や、セットアップの手間がかかる
  なんか社内でもWindows 7とかXPとか混在してたし選択から除外

TeraTerm Macro?
---------------
  さすがにパーサは書けなさそう
  バイナリデータの扱いがちょっと苦手っぽい

Java?
-----
  互換性は置いても、JVMのインストールが面倒
  利用者に負担を強いる

Ruby?
-----
  互換性は置いても、RVMのインストールが面倒
  利用者に負担を強いる

C?
--
  これでパーサ書くのしんどい、、
  利用者の思いもよらない操作でメモリアクセス違反起こしそう
  (これで文句言われても、環境が違うと再現させる事が難しい)

Haskell
-------
  バイナリ配布でそのまま動く
  OSに対してはソースコードレベルで互換性とれそう
  パーサを書くのも簡単
  例外が起こりにくい、制御しやすいイメージ


という事でHaskellを使いました。


今は、上の経験を活かして
自分の作ってるユニットの

* 網羅的なブラックボックステスト
* 通信負荷試験

等にHaskellを利用しています。
